---
import BaseLayout from '../layouts/BaseLayout.astro';
import Chat from '../components/Chat.tsx';
import Section from '../components/Section.astro';
import SectionIndex from '../components/SectionIndex.astro';
import { getFeatureFlag } from '../lib/launchdarkly';

export const prerender = false;

const isChatEnabled = await getFeatureFlag('ai-chat', false);

if (!isChatEnabled) {
  return Astro.redirect('/', 307);
}
---

<BaseLayout title="Chat with Virtual Ray">
  <SectionIndex />
  <main>
    <Section id="chat" number="01" class="border-t border-border min-h-screen">
      <div class="flex flex-col sm:flex-row sm:justify-between sm:items-start gap-6 mb-12">
        <h1 class="type-section-title">Virtual Ray</h1>
        <p class="text-muted text-sm max-w-xs">
          Ask me anything about my experience, skills, or projects.
        </p>
      </div>
      <Chat client:load />
    </Section>
  </main>
</BaseLayout>
